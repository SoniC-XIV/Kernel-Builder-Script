name: Kernel Builder

on: # [push]
  workflow_dispatch:
  watch:
    types: [started]

env:
  CONFIG: config.sh
  TG_CHAT_ID:  ${{ secrets.CHAT_ID }}
  TG_TOKEN: ${{ secrets.BOT_API }}
  TZ: Asia/Jakarta

jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: ubuntu:jammy-20211029
    steps:
      - name: Checkout
        uses: actions/checkout@master

      - name: setup environment
      run: |
          sudo apt-get update --fix-missing
          sudo apt-get install git make bc bison \
          openssl curl zip kmod cpio flex libelf-dev \
          libssl-dev libtfm-dev wget device-tree-compiler \
          ca-certificates python3 python2 binutils \
          binutils-aarch64-linux-gnu binutils-arm-linux-gnueabi \
          libghc-libyaml-dev libyaml-dev glibc-source \

      shell: bash
        - name: Sync Source ‚è≥
           run: bash sync.sh

        - name: Building Kernel üñ•Ô∏è
           run: bash build.sh | tee ${HOME}/build.log
